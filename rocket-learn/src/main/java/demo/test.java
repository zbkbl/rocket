package demo;

import com.alibaba.fastjson.JSONObject;
import com.google.common.collect.Lists;
import raw.Student;

import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.*;
import java.util.stream.Collectors;

/**
 * @author liuyang
 * @description test
 * @date 2020/01/14 11:17
 **/

@SuppressWarnings("all")
public class test {

    private static final DateTimeFormatter DATE_8_FORMAT = DateTimeFormatter.ofPattern("yyyyMMdd");

    public static void main(String[] args) {


        String s1 = "{\"191\":\"7\",\"473\":\"21\",\"118\":\"220301\",\"120\":\"101040100\",\"367\":\"0\",\"400\":\"0\",\"489\":\"20203\",\"369\":\"6.4\",\"768\":\"0.3043478\",\"802\":\"0.4\",\"769\":\"1.0\",\"803\":\"0.3254902\",\"2210\":\"0.055555556\",\"372\":\"0\",\"373\":\"5\",\"2207\":\"0.8108108\",\"770\":\"1.0\",\"2448\":\"2\",\"2206\":\"0.8636364\",\"771\":\"0.0\",\"2205\":\"0.0\",\"772\":\"0.04347826\",\"2204\":\"0.07692308\",\"773\":\"0.85915494\",\"2203\":\"0.01923077\",\"258\":\"9.0\",\"2202\":\"0.7878788\",\"2201\":\"27\",\"534\":\"220301\",\"776\":\"0.0\",\"2200\":\"2\",\"535\":\"2547\",\"777\":\"0.07017544\",\"2684\":\"445\",\"778\":\"0.01754386\",\"779\":\"0.8028169\",\"659\":\"57\",\"2209\":\"0.055555556\",\"2208\":\"0.011111111\",\"2180\":\"4\",\"2221\":\"1.35\",\"2188\":\"5\",\"2220\":\"0.1\",\"2187\":\"111\",\"2186\":\"5\",\"2184\":\"90\",\"2183\":\"57\",\"2182\":\"0\",\"2181\":\"66\",\"2218\":\"0.2\",\"660\":\"1\",\"2217\":\"0.2247191\",\"661\":\"4\",\"2216\":\"7.0\",\"662\":\"71\",\"2215\":\"1.0\",\"663\":\"0\",\"2214\":\"1.0\",\"2213\":\"0.0\",\"423\":\"0\",\"2212\":\"0.04347826\",\"666\":\"61\",\"2179\":\"1\",\"2211\":\"1.2777778\",\"2178\":\"52\",\"667\":\"102\",\"668\":\"1\",\"669\":\"5\",\"2219\":\"0.95\",\"2191\":\"0\",\"2190\":\"1\",\"2199\":\"89\",\"2198\":\"19\",\"2197\":\"4\",\"2196\":\"20\",\"2195\":\"7\",\"2194\":\"1\",\"790\":\"0.30337077\",\"2193\":\"23\",\"670\":\"126\",\"791\":\"0.1\",\"2192\":\"1\",\"671\":\"5\",\"792\":\"0.95\",\"672\":\"121\",\"793\":\"0.2\",\"431\":\"0.4087\",\"673\":\"166\",\"794\":\"0.2247191\",\"399\":\"11552\",\"674\":\"204\",\"795\":\"0.96031743\",\"675\":\"1\",\"796\":\"0.0877193\",\"676\":\"0\",\"797\":\"0.0877193\",\"677\":\"1\",\"798\":\"0.009803922\",\"678\":\"23\",\"799\":\"0.8095238\",\"2189\":\"115\",\"679\":\"1\",\"282\":\"32.0\",\"680\":\"7\",\"681\":\"20\",\"682\":\"4\",\"683\":\"19\",\"684\":\"89\",\"289\":\"4\",\"685\":\"2\",\"686\":\"27\",\"204\":\"-1\",\"722\":\"510\",\"2133\":\"4\",\"2132\":\"9\",\"292\":\"9\",\"210\":\"202\",\"179\":\"2\",\"212\":\"0\",\"974\":\"220000\",\"975\":\"220300\",\"217\":\"2\",\"977\":\"21\",\"589\":\"500112\"}";
        JSONObject activeFeatures = JSONObject.parseObject(s1);
        String s2 = "{\"2155\":\"0.4307508\",\"2154\":\"0.4307508\",\"2153\":\"0.4\",\"230\":\"0.187\",\"2548\":\"1\",\"2702\":\"0\",\"2547\":\"-1\",\"2426\":\"0\",\"2546\":\"0.5\",\"355\":\"1\",\"751\":\"0.0\",\"235\":\"1.127\",\"752\":\"0.0\",\"236\":\"0.128\",\"753\":\"0.0\",\"754\":\"0.0\",\"755\":\"0.0\",\"513\":\"0.0\",\"756\":\"0.09385475\",\"757\":\"0.0\",\"758\":\"0.73493975\",\"517\":\"0.0013096478\",\"759\":\"0.4698795\",\"2549\":\"103\",\"2166\":\"0.0\",\"2165\":\"0.0\",\"2164\":\"0.0\",\"2163\":\"1.0\",\"2041\":\"6\",\"2161\":\"1.0\",\"363\":\"29761539\",\"243\":\"0.918\",\"760\":\"0.0\",\"244\":\"0.098\",\"761\":\"0.03448276\",\"762\":\"0.03448276\",\"125\":\"140301\",\"763\":\"1.0\",\"2159\":\"0.144944\",\"764\":\"0.09954407\",\"1102\":\"0.0\",\"2157\":\"0.061522\",\"765\":\"0.069869\",\"644\":\"0.259406\",\"128\":\"101040100\",\"766\":\"0.6943231\",\"800\":\"0.1452377\",\"767\":\"0.44978166\",\"646\":\"0.66422\",\"801\":\"0.013559876\",\"2694\":\"0\",\"130\":\"101\",\"2170\":\"0.0\",\"495\":\"0.567487\",\"496\":\"0.6034226\",\"2447\":\"2550\",\"895\":\"0.0043098778\",\"774\":\"0.09273743\",\"379\":\"79\",\"775\":\"0.08700608\",\"2169\":\"0.0\",\"2168\":\"0.0\",\"139\":\"10.0\",\"414\":\"0.06795\",\"2167\":\"0.0\",\"418\":\"155647\",\"380\":\"500103\",\"381\":\"100303\",\"382\":\"302\",\"383\":\"0\",\"780\":\"0.0\",\"781\":\"0.0\",\"144\":\"1.0\",\"782\":\"0.0\",\"783\":\"0.0\",\"784\":\"0.0\",\"785\":\"0.09385475\",\"664\":\"229\",\"422\":\"0\",\"786\":\"0.0\",\"665\":\"83\",\"302\":\"33.0\",\"787\":\"0.73493975\",\"700\":\"7\",\"788\":\"0.4698795\",\"425\":\"0.0\",\"701\":\"84\",\"305\":\"10958\",\"789\":\"0.09273743\",\"702\":\"83\",\"306\":\"65637\",\"703\":\"39\",\"704\":\"61\",\"705\":\"895\",\"706\":\"7\",\"707\":\"84\",\"708\":\"83\",\"709\":\"889\",\"391\":\"0\",\"430\":\"4.0953\",\"710\":\"0\",\"2069\":\"0\",\"711\":\"0\",\"712\":\"0\",\"713\":\"0\",\"714\":\"59\",\"715\":\"61\",\"716\":\"0\",\"837\":\"1.0\",\"717\":\"0\",\"838\":\"1.0\",\"718\":\"0\",\"719\":\"0\",\"168\":\"2.0\",\"841\":\"0.196189\",\"720\":\"59\",\"687\":\"103\",\"842\":\"0.0\",\"721\":\"61\",\"688\":\"159\",\"843\":\"0.0\",\"689\":\"2632\",\"844\":\"0.0\",\"723\":\"6121\",\"845\":\"0.19449\",\"846\":\"0.0\",\"725\":\"0.46659365\",\"847\":\"0.0\",\"848\":\"0.0\",\"849\":\"0.0\",\"171\":\"201\",\"690\":\"16\",\"174\":\"7\",\"691\":\"262\",\"692\":\"29\",\"693\":\"1\",\"177\":\"9\",\"694\":\"1\",\"695\":\"29\",\"299\":\"0.0\",\"850\":\"0.2\",\"696\":\"220\",\"1037\":\"0\",\"697\":\"39\",\"852\":\"1.0\",\"973\":\"140300\",\"698\":\"61\",\"1036\":\"0\",\"853\":\"1.0\",\"699\":\"895\",\"1035\":\"0\",\"732\":\"0\",\"854\":\"0.357133\",\"733\":\"0\",\"855\":\"0.658192\",\"734\":\"0\",\"856\":\"0.403286\",\"735\":\"0\",\"857\":\"1.0\",\"859\":\"0.947715\",\"1055\":\"0.075344\",\"2140\":\"-1\",\"860\":\"0.061522\",\"861\":\"1.0\",\"223\":\"0.949\",\"224\":\"0.092\",\"865\":\"0.807637\",\"624\":\"0.02\",\"625\":\"0.06795\",\"229\":\"1.462\",\"626\":\"0.02\",\"505\":\"0.247973\",\"506\":\"0.116655\",\"749\":\"4567755\",\"507\":\"0.0\",\"904\":\"160000\",\"508\":\"0.0\"}";
        JSONObject passiveFeatures = JSONObject.parseObject(s2);
        String trace = "{\"118\":\"220301\",\"120\":\"101040100\",\"125\":\"140301\",\"128\":\"101040100\",\"130\":\"101\",\"139\":\"10.0\",\"144\":\"1.0\",\"168\":\"2.0\",\"171\":\"201\",\"174\":\"7\",\"177\":\"9\",\"179\":\"2\",\"191\":\"7\",\"204\":\"-1\",\"210\":\"202\",\"212\":\"0\",\"217\":\"2\",\"223\":\"0.949\",\"224\":\"0.092\",\"229\":\"1.462\",\"230\":\"0.187\",\"235\":\"1.127\",\"236\":\"0.128\",\"243\":\"0.918\",\"244\":\"0.098\",\"258\":\"4.0\",\"282\":\"32.0\",\"289\":\"4\",\"292\":\"9\",\"299\":\"0.0\",\"302\":\"33.0\",\"305\":\"10958\",\"306\":\"65637\",\"355\":\"1\",\"363\":\"29761539\",\"367\":\"0\",\"369\":\"6.4\",\"372\":\"0\",\"373\":\"5\",\"379\":\"79\",\"380\":\"500103\",\"381\":\"100303\",\"382\":\"302\",\"383\":\"0\",\"391\":\"0\",\"399\":\"11552\",\"400\":\"0\",\"414\":\"0.06795\",\"418\":\"155647\",\"422\":\"0\",\"423\":\"0\",\"425\":\"0.0\",\"430\":\"4.0953\",\"431\":\"0.4087\",\"473\":\"21\",\"489\":\"20203\",\"495\":\"0.567487\",\"496\":\"0.6034226\",\"505\":\"0.247973\",\"506\":\"0.116655\",\"507\":\"0.0\",\"508\":\"0.0\",\"513\":\"0.0\",\"517\":\"0.0013096478\",\"534\":\"220301\",\"535\":\"2547\",\"589\":\"500112\",\"624\":\"0.02\",\"625\":\"0.06795\",\"626\":\"0.02\",\"644\":\"0.259406\",\"646\":\"0.66422\",\"659\":\"57\",\"660\":\"1\",\"661\":\"4\",\"662\":\"71\",\"663\":\"0\",\"664\":\"229\",\"665\":\"83\",\"666\":\"61\",\"667\":\"102\",\"668\":\"1\",\"669\":\"5\",\"670\":\"126\",\"671\":\"5\",\"672\":\"121\",\"673\":\"166\",\"674\":\"204\",\"675\":\"1\",\"676\":\"0\",\"677\":\"1\",\"678\":\"23\",\"679\":\"1\",\"680\":\"7\",\"681\":\"20\",\"682\":\"4\",\"683\":\"19\",\"684\":\"89\",\"685\":\"2\",\"686\":\"27\",\"687\":\"103\",\"688\":\"159\",\"689\":\"2632\",\"690\":\"16\",\"691\":\"262\",\"692\":\"29\",\"693\":\"1\",\"694\":\"1\",\"695\":\"29\",\"696\":\"220\",\"697\":\"39\",\"698\":\"61\",\"699\":\"895\",\"700\":\"7\",\"701\":\"84\",\"702\":\"83\",\"703\":\"39\",\"704\":\"61\",\"705\":\"895\",\"706\":\"7\",\"707\":\"84\",\"708\":\"83\",\"709\":\"889\",\"710\":\"0\",\"711\":\"0\",\"712\":\"0\",\"713\":\"0\",\"714\":\"59\",\"715\":\"61\",\"716\":\"0\",\"717\":\"0\",\"718\":\"0\",\"719\":\"0\",\"720\":\"59\",\"721\":\"61\",\"722\":\"510\",\"723\":\"6121\",\"725\":\"0.46659365\",\"732\":\"0\",\"733\":\"0\",\"734\":\"0\",\"735\":\"0\",\"749\":\"4567755\",\"751\":\"0.0\",\"752\":\"0.0\",\"753\":\"0.0\",\"754\":\"0.0\",\"755\":\"0.0\",\"756\":\"0.09385475\",\"757\":\"0.0\",\"758\":\"0.73493975\",\"759\":\"0.4698795\",\"760\":\"0.0\",\"761\":\"0.03448276\",\"762\":\"0.03448276\",\"763\":\"1.0\",\"764\":\"0.09954407\",\"765\":\"0.069869\",\"766\":\"0.6943231\",\"767\":\"0.44978166\",\"768\":\"0.3043478\",\"769\":\"1.0\",\"770\":\"1.0\",\"771\":\"0.0\",\"772\":\"0.04347826\",\"773\":\"0.85915494\",\"774\":\"0.09273743\",\"775\":\"0.08700608\",\"776\":\"0.0\",\"777\":\"0.07017544\",\"778\":\"0.01754386\",\"779\":\"0.8028169\",\"780\":\"0.0\",\"781\":\"0.0\",\"782\":\"0.0\",\"783\":\"0.0\",\"784\":\"0.0\",\"785\":\"0.09385475\",\"786\":\"0.0\",\"787\":\"0.73493975\",\"788\":\"0.4698795\",\"789\":\"0.09273743\",\"790\":\"0.30337077\",\"791\":\"0.1\",\"792\":\"0.95\",\"793\":\"0.2\",\"794\":\"0.2247191\",\"795\":\"0.96031743\",\"796\":\"0.0877193\",\"797\":\"0.0877193\",\"798\":\"0.009803922\",\"799\":\"0.8095238\",\"800\":\"0.1452377\",\"801\":\"0.013559876\",\"802\":\"0.4\",\"803\":\"0.3254902\",\"837\":\"1.0\",\"838\":\"1.0\",\"841\":\"0.196189\",\"842\":\"0.0\",\"843\":\"0.0\",\"844\":\"0.0\",\"845\":\"0.19449\",\"846\":\"0.0\",\"847\":\"0.0\",\"848\":\"0.0\",\"849\":\"0.0\",\"850\":\"0.2\",\"852\":\"1.0\",\"853\":\"1.0\",\"854\":\"0.357133\",\"855\":\"0.658192\",\"856\":\"0.403286\",\"857\":\"1.0\",\"859\":\"0.947715\",\"860\":\"0.061522\",\"861\":\"1.0\",\"865\":\"0.807637\",\"895\":\"0.0043098778\",\"904\":\"160000\",\"973\":\"140300\",\"974\":\"220000\",\"975\":\"220300\",\"977\":\"21\",\"1035\":\"0\",\"1036\":\"0\",\"1037\":\"0\",\"1055\":\"0.075344\",\"1102\":\"0.0\",\"2041\":\"6\",\"2069\":\"0\",\"2132\":\"9\",\"2133\":\"4\",\"2140\":\"-1\",\"2153\":\"0.4\",\"2154\":\"0.4307508\",\"2155\":\"0.4307508\",\"2157\":\"0.061522\",\"2159\":\"0.144944\",\"2161\":\"1.0\",\"2163\":\"1.0\",\"2164\":\"0.0\",\"2165\":\"0.0\",\"2166\":\"0.0\",\"2167\":\"0.0\",\"2168\":\"0.0\",\"2169\":\"0.0\",\"2170\":\"0.0\",\"2178\":\"52\",\"2179\":\"1\",\"2180\":\"4\",\"2181\":\"66\",\"2182\":\"0\",\"2183\":\"57\",\"2184\":\"90\",\"2186\":\"5\",\"2187\":\"111\",\"2188\":\"5\",\"2189\":\"115\",\"2190\":\"1\",\"2191\":\"0\",\"2192\":\"1\",\"2193\":\"23\",\"2194\":\"1\",\"2195\":\"7\",\"2196\":\"20\",\"2197\":\"4\",\"2198\":\"19\",\"2199\":\"89\",\"2200\":\"2\",\"2201\":\"27\",\"2202\":\"0.7878788\",\"2203\":\"0.01923077\",\"2204\":\"0.07692308\",\"2205\":\"0.0\",\"2206\":\"0.8636364\",\"2207\":\"0.8108108\",\"2208\":\"0.011111111\",\"2209\":\"0.055555556\",\"2210\":\"0.055555556\",\"2211\":\"1.2777778\",\"2212\":\"0.04347826\",\"2213\":\"0.0\",\"2214\":\"1.0\",\"2215\":\"1.0\",\"2216\":\"7.0\",\"2217\":\"0.2247191\",\"2218\":\"0.2\",\"2219\":\"0.95\",\"2220\":\"0.1\",\"2221\":\"1.35\",\"2426\":\"0\",\"2447\":\"2550\",\"2448\":\"2\",\"2546\":\"0.5\",\"2547\":\"-1\",\"2548\":\"1\",\"2549\":\"103\",\"2684\":\"479\",\"2694\":\"0\",\"2702\":\"0\"}";
        JSONObject traceFeatures = JSONObject.parseObject(trace);
        String hive = "{\"907\":\"[104,101,103,101,104,101,103,101,101,104]\",\"908\":\"[3,0,3,0,0,0,0,0,0,0]\",\"909\":\"[306,302,306,302,303,303,305,303,304,302]\",\"2792\":\"[29283378,107160619,502901240,30718185,123918519,114283712,41182302,59660538,60674916,58094660,501709335,117468684,117925364,71201896,69255524,47475726,83742658,28244419,72937411,122322597,53917162,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2791\":\"[100358587,78956398,103067685,103069167,104952264,102989776,97506721,93694495,105293542,105311662,105508923,92824674,99243569,93173061,94615644,98292421,101351046,100070726,91391436,94011503,101909112,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2790\":\"[29283378,107160619,502901240,30718185,123918519,114283712,41182302,59660538,60674916,58094660,501709335,117468684,117925364,71201896,69255524,47475726,83742658,28244419,72937411,122322597,53917162,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2548\":\"1\",\"2547\":\"-1\",\"2426\":\"0\",\"2789\":\"[100358587,78956398,103067685,103069167,104952264,102989776,97506721,93694495,105293542,105311662,105508923,92824674,99243569,93173061,94615644,98292421,101351046,100070726,91391436,94011503,101909112,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2546\":\"0.5\",\"2425\":\"0\",\"2542\":\"0.3611223\",\"2784\":\"1\",\"2541\":\"0.5427324\",\"910\":\"[801,801,801,808,802,801,808,801,808,808]\",\"911\":\"[1,3,1,1,1,1,1,1,3,3]\",\"2549\":\"103\",\"2799\":\"1\",\"1102\":\"0.0\",\"2794\":\"-223799\",\"800\":\"0.1452377\",\"801\":\"0.013559876\",\"802\":\"0.4\",\"803\":\"0.3254902\",\"2694\":\"0\",\"2210\":\"0.055555556\",\"1000\":\"[101,103,104,101,104,101,103,103,101,103]\",\"2693\":\"0\",\"2207\":\"0.8108108\",\"2448\":\"2\",\"2206\":\"0.8636364\",\"2205\":\"0.0\",\"2689\":\"[140310,140311,140301,140302,140303,140314,140307,220303]\",\"2204\":\"0.07692308\",\"2688\":\"{\\\"140310\\\":0.10526316,\\\"140311\\\":0.10526316,\\\"140301\\\":0.10526316,\\\"140302\\\":0.10526316,\\\"140303\\\":0.10526316,\\\"140314\\\":0.10526316,\\\"140307\\\":0.10526316,\\\"220303\\\":0.2631579}\",\"2203\":\"0.01923077\",\"2687\":\"[-3,-3,-3,-3,-3]\",\"2202\":\"0.7878788\",\"2686\":\"0\",\"2201\":\"27\",\"2685\":\"0\",\"2200\":\"2\",\"2684\":\"479\",\"2209\":\"0.055555556\",\"2208\":\"0.011111111\",\"2221\":\"1.35\",\"2342\":\"[220301,220301,220301,220401,220301,220301,140302,220401,220301,220301,220401,220401,220401,140311,220301,220303,220301,140302,150104,140303]\",\"2462\":\"1.107\",\"2220\":\"0.1\",\"2341\":\"39879931:1603439267450,100596321:1603439331584,100632987:1603439362422,66006998:1603439374538,99737803:1603439405191,98854145:1603439447713,95199798:1603439457603,98018207:1603439467083,78099059:1603439610940,78099059:1603439621628,105250070:1603439633422,105250070:1603439641669,99336214:1603439660183,90876712:1603439735545,39879931:1603441922412,106214162:1603441951213,105099946:1603441962168,102295409:1603442013040,105559509:1603442043328,93240112:1603442087071\",\"2461\":\"0.134\",\"2460\":\"1.022\",\"1129\":\"0\",\"2218\":\"0.2\",\"1008\":\"[150104,220401,140303,220301,140311,220301,220301,220401,140302,220301]\",\"2459\":\"0.127\",\"1128\":\"0\",\"2217\":\"0.2247191\",\"1007\":\"[801,808,801,803,807,807,0,808,808,0]\",\"2458\":\"0.972\",\"1127\":\"0\",\"2216\":\"7.0\",\"1006\":\"[303,306,303,301,306,306,301,306,302,301]\",\"2457\":\"0.098\",\"2215\":\"1.0\",\"1005\":\"[100025,100702,100019,100014,100706,100706,100003,100702,100208,100003]\",\"2456\":\"1.028\",\"2214\":\"1.0\",\"1004\":\"[6,4,10,12,10,12,5,4,11,5]\",\"2455\":\"0.121\",\"2213\":\"0.0\",\"1003\":\"[4,3,5,8,6,7,4,3,6,4]\",\"1123\":\"1\",\"2212\":\"0.04347826\",\"1002\":\"[201,201,201,201,202,206,201,201,201,201]\",\"2696\":\"1\",\"700\":\"7\",\"2695\":\"1\",\"2211\":\"1.2777778\",\"1001\":\"[0,4,0,0,0,4,0,4,0,0]\",\"701\":\"84\",\"702\":\"83\",\"703\":\"39\",\"704\":\"61\",\"705\":\"895\",\"706\":\"7\",\"707\":\"84\",\"708\":\"83\",\"2219\":\"0.95\",\"709\":\"889\",\"2351\":\"[202,201,201,206,206,201,201,202,202,202,201,201,202,202,202,208,201,201,201,201]\",\"2349\":\"[5,20,10,4,15,8,8,4,5,5,3,3,4,8,5,10,6,6,4,5]\",\"2347\":\"[7,40,15,5,30,13,13,5,10,10,4,4,5,13,7,11,11,11,6,10]\",\"2345\":\"[305,306,302,306,303,302,301,305,305,305,306,306,305,302,305,305,302,302,303,303]\",\"710\":\"0\",\"711\":\"0\",\"2222\":\"[0,104,0,0,0,322,0,104,0,0]\",\"2343\":\"[801,808,808,808,808,0,0,807,801,801,808,808,807,801,801,807,801,808,801,801]\",\"712\":\"0\",\"713\":\"0\",\"714\":\"59\",\"715\":\"61\",\"716\":\"0\",\"837\":\"1.0\",\"717\":\"0\",\"838\":\"1.0\",\"718\":\"0\",\"839\":\"0.194338\",\"719\":\"0\",\"1033\":\"[7021,2988,363,62916806,34588962,35097679,361,2988,361,361]\",\"2364\":\"0\",\"1032\":\"[34569103,34588962,34569361,363,363,363,363,57237451,34586632,35021521]\",\"1031\":\"[37,37,1337,320421,311145,-3,-3,-3,-3,-3]\",\"2362\":\"[101,101,101,101,101,101,101,101,104,101,104,104,101,103,101,101,101,103,101,104]\",\"1030\":\"[220301,140301,220301,140314,150104,140303,150104,150104,150104,150104]\",\"2361\":\"[206,201,208,201,201,201,201,201,202,201,202,202,201,202,201,201,201,201,201,201]\",\"2360\":\"[7,5,5,10,4,4,4,5,4,3,5,5,4,5,5,4,5,10,5,10]\",\"1029\":\"[100706,100403,100706,100002,100104,100019,100704,100104,100021,100704]\",\"1028\":\"[15,9,15,10,9,10,8,8,8,10]\",\"2359\":\"[12,8,6,15,9,6,6,10,5,8,10,8,8,8,10,9,10,15,9,15]\",\"1027\":\"[10,5,10,5,4,5,5,4,5,5]\",\"2358\":\"[306,302,304,302,302,303,302,303,303,303,303,302,304,305,303,303,302,306,302,306]\",\"840\":\"0.04251\",\"2599\":\"[103992968,103067685,92824674,94011503,100070726,100070726,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2357\":\"[807,0,0,808,801,801,801,801,808,0,802,808,808,808,801,801,808,801,801,801]\",\"841\":\"0.196189\",\"720\":\"59\",\"2598\":\"[154221925,161211544,155785788,125897443,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2356\":\"[220301,150104,150104,220301,130305,140304,150104,140303,150104,150104,150104,150104,150104,150104,140303,150104,140314,220301,140301,220301]\",\"842\":\"0.0\",\"721\":\"61\",\"2355\":\"101909112:1602559981957,94011503:1602903063838,91391436:1602903803916,100070726:1602919346862,101351046:1602919370766,98292421:1603066542015,94615644:1603066667718,93173061:1603066732498,99243569:1603067925859,92824674:1603175297626,104952264:1603182123286,105311662:1603182182750,105293542:1603182221686,97506721:1603182282359,93694495:1603185981470,102989776:1603187510839,103069167:1603187840728,103067685:1603188306711,78956398:1603189097889,100358587:1603439152502\",\"843\":\"0.0\",\"964\":\"0\",\"722\":\"510\",\"2354\":\"[103,101,101,101,101,104,101,101,104,104,103,103,101,101,103,101,101,101,101,104]\",\"844\":\"0.0\",\"723\":\"6121\",\"965\":\"0\",\"845\":\"0.19449\",\"603\":\"0.0\",\"966\":\"0\",\"724\":\"2547\",\"846\":\"0.0\",\"725\":\"0.46659365\",\"967\":\"0\",\"847\":\"0.0\",\"968\":\"0\",\"848\":\"0.0\",\"969\":\"0\",\"849\":\"0.0\",\"607\":\"0.0\",\"2375\":\"0\",\"2133\":\"4\",\"2254\":\"1\",\"2374\":\"0\",\"2132\":\"9\",\"2252\":\"0\",\"2373\":\"0\",\"2372\":\"0\",\"2251\":\"0\",\"970\":\"0\",\"850\":\"0.2\",\"971\":\"0\",\"1037\":\"0\",\"730\":\"0\",\"972\":\"0\",\"2368\":\"0\",\"852\":\"1.0\",\"973\":\"140300\",\"731\":\"0\",\"1036\":\"0\",\"2367\":\"0\",\"853\":\"1.0\",\"732\":\"0\",\"974\":\"220000\",\"1035\":\"0\",\"2366\":\"0\",\"854\":\"0.357133\",\"733\":\"0\",\"975\":\"220300\",\"1034\":\"[0,104,0,0,0,322,0,104,0,0]\",\"2365\":\"0\",\"855\":\"0.658192\",\"734\":\"0\",\"856\":\"0.403286\",\"735\":\"0\",\"977\":\"21\",\"857\":\"1.0\",\"736\":\"0\",\"737\":\"0\",\"859\":\"0.947715\",\"1055\":\"0.075344\",\"2144\":\"[4,3,5,8,6,7,4,3,6,4]\",\"1054\":\"30\",\"2143\":\"[201,201,201,201,202,206,201,201,201,201]\",\"2142\":\"[0,4,0,0,0,4,0,4,0,0]\",\"1053\":\"30\",\"2141\":\"[101,103,104,101,104,101,103,103,101,103]\",\"2140\":\"0\",\"860\":\"0.061522\",\"2139\":\"[9,-3,-3]\",\"861\":\"1.0\",\"2138\":\"[4,-3,-3]\",\"862\":\"0.0\",\"2137\":\"[220300,-3,-3]\",\"621\":\"1603456109590\",\"2136\":\"[220000,-3,-3]\",\"2257\":\"0\",\"743\":\"0\",\"2135\":\"[220301,-3,-3]\",\"2256\":\"0\",\"865\":\"0.807637\",\"2376\":\"0\",\"2134\":\"[101040100,-3,-3]\",\"2255\":\"0\",\"624\":\"0.02\",\"745\":\"0\",\"625\":\"0.06795\",\"504\":\"4.0953\",\"626\":\"0.02\",\"505\":\"0.247973\",\"506\":\"0.116655\",\"749\":\"4567755\",\"507\":\"0.0\",\"628\":\"7686\",\"508\":\"0.0\",\"2155\":\"0.4307508\",\"2154\":\"0.4307508\",\"2153\":\"0.4\",\"2152\":\"[220301,140301,220301,140314,150104,150104,150104,140303,150104,150104]\",\"2151\":\"[10,5,10,5,5,4,5,5,4,5]\",\"2150\":\"[15,9,15,10,10,9,8,10,8,8]\",\"1060\":\"0\",\"751\":\"0.0\",\"2149\":\"[150104,220401,140303,220301,140311,220301,220301,220401,140302,220301]\",\"752\":\"0.0\",\"2148\":\"[801,808,801,803,807,807,0,808,808,0]\",\"753\":\"0.0\",\"2147\":\"[303,306,303,301,306,306,301,306,302,301]\",\"754\":\"0.0\",\"2146\":\"[100025,100702,100019,100014,100706,100706,100003,100702,100208,100003]\",\"755\":\"0.0\",\"513\":\"0.0\",\"2145\":\"[6,4,10,12,10,12,5,4,11,5]\",\"756\":\"0.09385475\",\"514\":\"0\",\"757\":\"0.0\",\"515\":\"1.0\",\"758\":\"0.73493975\",\"516\":\"0.274\",\"517\":\"0.0013096478\",\"759\":\"0.4698795\",\"2166\":\"0.0\",\"3013\":\"0.1011258\",\"2165\":\"0.0\",\"3012\":\"0.1011258\",\"2164\":\"0.0\",\"3011\":\"0.1011258\",\"2163\":\"1.0\",\"3010\":\"0.1011258\",\"2042\":\"[-3,-3,-3,-3,-3,-3,-3,-3,-3,500112,500105,500112,500105,500105,500105,500105,500105,500112,500105,500105,500112,500105,500105,500105,500105,500105,500105,500112,500112,500112]\",\"2041\":\"6\",\"2161\":\"1.0\",\"2040\":\"4065:0.1,516:0.1,36:0.1,2694:0.1,23:0.1,2823:0.1,523:0.1,524:0.1,30:0.1,926:0.1,\",\"760\":\"0.0\",\"3009\":\"0.07676547\",\"761\":\"0.03448276\",\"3008\":\"0.0\",\"762\":\"0.03448276\",\"3007\":\"0.0\",\"2039\":\"994:0.0214,419:0.0864,516:0.034,996:0.033,137:0.0277,1002:0.027,299:0.034,523:0.034,524:0.034,142:0.0843,656:0.027,340:0.0609,565:0.027,23:0.1246,603:0.0585,348:0.033,926:0.1056,30:0.0939,94:0.027,543:0.027,\",\"763\":\"1.0\",\"2159\":\"0.144944\",\"3006\":\"0.0\",\"400\":\"0\",\"764\":\"0.09954407\",\"643\":\"0.259406\",\"3005\":\"0.07676547\",\"2157\":\"0.061522\",\"765\":\"0.069869\",\"644\":\"0.259406\",\"766\":\"0.6943231\",\"645\":\"0.66422\",\"767\":\"0.44978166\",\"646\":\"0.66422\",\"768\":\"0.3043478\",\"769\":\"1.0\",\"528\":\"0\",\"3021\":\"[500105,500105,500105,500116,500112,500112,500108,500105,500108,500108]\",\"2052\":\"-1\",\"3020\":\"[500112,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2170\":\"0.0\",\"770\":\"1.0\",\"650\":\"0.218\",\"771\":\"0.0\",\"651\":\"0.009\",\"772\":\"0.04347826\",\"652\":\"1.0\",\"773\":\"0.85915494\",\"895\":\"0.0043098778\",\"774\":\"0.09273743\",\"653\":\"0.46659365\",\"775\":\"0.08700608\",\"2169\":\"0.0\",\"2168\":\"0.0\",\"413\":\"1.0\",\"3015\":\"0.1011258\",\"534\":\"220301\",\"776\":\"0.0\",\"414\":\"0.06795\",\"2167\":\"0.0\",\"535\":\"2547\",\"777\":\"0.07017544\",\"656\":\"0,1\",\"778\":\"0.01754386\",\"779\":\"0.8028169\",\"659\":\"57\",\"418\":\"155647\",\"2180\":\"4\",\"2188\":\"5\",\"2187\":\"111\",\"2186\":\"5\",\"2185\":\"1\",\"2184\":\"90\",\"2183\":\"57\",\"2182\":\"0\",\"780\":\"0.0\",\"2181\":\"66\",\"781\":\"0.0\",\"660\":\"1\",\"782\":\"0.0\",\"661\":\"4\",\"783\":\"0.0\",\"662\":\"71\",\"784\":\"0.0\",\"421\":\"0.0\",\"663\":\"0\",\"785\":\"0.09385475\",\"664\":\"229\",\"422\":\"0\",\"786\":\"0.0\",\"665\":\"83\",\"302\":\"33.0\",\"423\":\"0\",\"787\":\"0.73493975\",\"666\":\"61\",\"2179\":\"1\",\"788\":\"0.4698795\",\"425\":\"0.0\",\"2178\":\"52\",\"667\":\"102\",\"305\":\"10958\",\"789\":\"0.09273743\",\"668\":\"1\",\"306\":\"65637\",\"669\":\"5\",\"548\":\"13364\",\"2191\":\"0\",\"2190\":\"1\",\"2199\":\"89\",\"2198\":\"19\",\"2197\":\"4\",\"2196\":\"20\",\"2195\":\"7\",\"2194\":\"1\",\"790\":\"0.30337077\",\"2193\":\"23\",\"670\":\"126\",\"791\":\"0.1\",\"2192\":\"1\",\"671\":\"5\",\"792\":\"0.95\",\"430\":\"4.0953\",\"672\":\"121\",\"793\":\"0.2\",\"431\":\"0.4087\",\"673\":\"166\",\"794\":\"0.2247191\",\"674\":\"204\",\"795\":\"0.96031743\",\"675\":\"1\",\"796\":\"0.0877193\",\"433\":\"2:2020\",\"676\":\"0\",\"797\":\"0.0877193\",\"677\":\"1\",\"798\":\"0.009803922\",\"557\":\"0.0\",\"678\":\"23\",\"799\":\"0.8095238\",\"2189\":\"115\",\"679\":\"1\",\"317\":\"0\",\"680\":\"7\",\"681\":\"20\",\"682\":\"4\",\"683\":\"19\",\"684\":\"89\",\"685\":\"2\",\"686\":\"27\",\"687\":\"103\",\"688\":\"159\",\"204\":\"-1\",\"689\":\"2632\",\"690\":\"16\",\"691\":\"262\",\"692\":\"29\",\"693\":\"1\",\"694\":\"1\",\"210\":\"202\",\"695\":\"29\",\"696\":\"220\",\"212\":\"0\",\"697\":\"39\",\"698\":\"61\",\"699\":\"895\",\"578\":\"0.00272\",\"215\":\"6.0\",\"217\":\"2\",\"461\":\"0.74594474\",\"462\":\"0.67639065\",\"223\":\"0.949\",\"224\":\"0.092\",\"467\":\"0\",\"588\":\"0.00272\",\"468\":\"0\",\"589\":\"500112\",\"229\":\"1.462\",\"590\":\"949,34571446,34942168\",\"230\":\"0.187\",\"473\":\"21\",\"355\":\"1\",\"235\":\"1.127\",\"236\":\"0.128\",\"357\":\"1603366100000\",\"358\":\"1603456109590\",\"118\":\"220301\",\"480\":\"0.419461\",\"481\":\"0\",\"120\":\"101040100\",\"363\":\"29761539\",\"243\":\"0.918\",\"244\":\"0.098\",\"125\":\"140301\",\"367\":\"0\",\"489\":\"20203\",\"368\":\"220301\",\"369\":\"6.4\",\"128\":\"101040100\",\"130\":\"101\",\"372\":\"0\",\"373\":\"5\",\"495\":\"0.567487\",\"496\":\"0.6034226\",\"497\":\"0.0\",\"498\":\"0.6034226\",\"379\":\"79\",\"258\":\"4.0\",\"139\":\"10.0\",\"380\":\"500103\",\"381\":\"100303\",\"382\":\"302\",\"383\":\"0\",\"144\":\"1.0\",\"386\":\"0\",\"387\":\"0\",\"391\":\"0\",\"395\":\"0\",\"399\":\"11552\",\"282\":\"32.0\",\"168\":\"2.0\",\"289\":\"4\",\"2917\":\"0\",\"2916\":\"[140302,160201]\",\"171\":\"201\",\"292\":\"9\",\"174\":\"7\",\"177\":\"9\",\"2800\":\"1\",\"299\":\"0.0\",\"2920\":\"-1\",\"179\":\"2\",\"2929\":\"1093\",\"2928\":\"0\",\"2927\":\"1093\",\"2926\":\"79\",\"2925\":\"115094\",\"2802\":\"0\",\"2933\":\"43200\",\"2932\":\"1\",\"2931\":\"2594\",\"2930\":\"0\",\"2939\":\"0\",\"2817\":\"0\",\"2938\":\"52\",\"2816\":\"0\",\"2937\":\"76144\",\"2936\":\"1\",\"2814\":\"1603366100000\",\"2935\":\"2594\",\"2934\":\"30\",\"191\":\"7\",\"2702\":\"0\",\"2701\":\"0\",\"2708\":\"0\",\"2707\":\"0.0\",\"2826\":\"0\",\"2705\":\"[220301,140311,220301,140311,220301,140311,220301,140311,220301,140311]\",\"2825\":\"0\",\"2704\":\"0\",\"2824\":\"0\",\"2834\":\"1596616100000\",\"2952\":\"0.0\",\"2831\":\"0\",\"2719\":\"0\",\"2837\":\"0\",\"2836\":\"1\",\"2715\":\"0.0\",\"2714\":\"0.0\",\"2603\":\"1\",\"2720\":\"0\",\"2606\":\"1\",\"2847\":\"1\",\"2614\":\"0\",\"2851\":\"0\",\"2850\":\"1\",\"2739\":\"0.68316907\",\"2859\":\"0\",\"2746\":\"0.68316907\",\"2866\":\"-1.0\",\"2745\":\"0.68316907\",\"2865\":\"0\",\"2744\":\"0.07676547\",\"2743\":\"0.19411862\",\"2742\":\"0.0\",\"2741\":\"0.0\",\"2740\":\"0.57277304\",\"2748\":\"0.0\",\"2747\":\"0.0\",\"2878\":\"0\",\"2635\":\"0.7372681\",\"2632\":\"0\",\"2631\":\"0\",\"2872\":\"0\",\"2639\":\"0\",\"2771\":\"0\",\"2892\":\"0\",\"2643\":\"[149,159,140,154,207,146,205,81,143,162,139,172,221,43,27,105,201,112,92,88]\",\"2764\":\"{\\\"220301\\\":1.1425415,\\\"220303\\\":0.7709491,\\\"140303\\\":0.59625536,\\\"220402\\\":0.5048431,\\\"140301\\\":0.48036432,\\\"140310\\\":0.3975905,\\\"160401\\\":0.086162165}\",\"2763\":\"{\\\"140301\\\":0.767982,\\\"140311\\\":0.46827912,\\\"140303\\\":0.02187412}\",\"2648\":\"[95622888,95622888,95622888,95622888,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3]\",\"2777\":\"1598953085000\",\"2414\":\"0\",\"2776\":\"0\",\"2412\":\"1.0\",\"2652\":\"500105:14,500112:7\",\"904\":\"160000\",\"905\":\"[12,7,12,7,7,6,6,7,6,6]\",\"2418\":\"1.0\",\"2417\":\"0\",\"906\":\"[201,201,201,201,202,201,202,201,201,202]\"}";
        JSONObject hiveFeatures = JSONObject.parseObject(hive);
        Set<String> hiveCode = traceFeatures.keySet();


        String s3 = "{\"678:3\":\"180\",\"425:3\":\"92\",\"2157:3\":\"70\",\"715:3\":\"148\",\"2195:3\":\"206\",\"380:3\":\"36\",\"534:3\":\"24\",\"764:3\":\"227\",\"787:3\":\"249\",\"753:3\":\"234\",\"2205:3\":\"292\",\"801:3\":\"253\",\"847:3\":\"77\",\"670:3\":\"188\",\"693:3\":\"132\",\"210:3\":\"6\",\"2220:3\":\"277\",\"1055:3\":\"67\",\"414:3\":\"106\",\"689:3\":\"136\",\"2168:3\":\"86\",\"791:3\":\"265\",\"229:3\":\"100\",\"749:3\":\"115\",\"2183:3\":\"217\",\"703:3\":\"160\",\"776:3\":\"260\",\"799:3\":\"273\",\"244:3\":\"93\",\"507:3\":\"60\",\"2217:3\":\"280\",\"681:3\":\"177\",\"859:3\":\"58\",\"666:3\":\"192\",\"282:3\":\"199\",\"861:3\":\"62\",\"2133:3\":\"27\",\"2179:3\":\"221\",\"174:3\":\"43\",\"2194:3\":\"207\",\"381:3\":\"37\",\"714:3\":\"149\",\"763:3\":\"226\",\"786:3\":\"248\",\"752:3\":\"233\",\"2204:3\":\"293\",\"305:3\":\"114\",\"800:3\":\"252\",\"692:3\":\"133\",\"677:3\":\"181\",\"846:3\":\"79\",\"850:3\":\"83\",\"790:3\":\"264\",\"2167:3\":\"87\",\"355:3\":\"33\",\"2182:3\":\"218\",\"725:3\":\"109\",\"775:3\":\"231\",\"798:3\":\"272\",\"702:3\":\"161\",\"680:3\":\"178\",\"506:3\":\"119\",\"2216:3\":\"281\",\"665:3\":\"167\",\"688:3\":\"137\",\"430:3\":\"116\",\"2155:3\":\"111\",\"367:3\":\"13\",\"860:3\":\"63\",\"2178:3\":\"222\",\"2132:3\":\"26\",\"713:3\":\"150\",\"762:3\":\"225\",\"785:3\":\"247\",\"2193:3\":\"208\",\"382:3\":\"38\",\"2170:3\":\"91\",\"751:3\":\"232\",\"691:3\":\"134\",\"2203:3\":\"294\",\"235:3\":\"96\",\"517:3\":\"170\",\"258:3\":\"198\",\"306:3\":\"113\",\"212:3\":\"8\",\"676:3\":\"182\",\"699:3\":\"164\",\"845:3\":\"81\",\"895:3\":\"120\",\"626:3\":\"105\",\"709:3\":\"154\",\"2166:3\":\"88\",\"2189:3\":\"212\",\"379:3\":\"35\",\"125:3\":\"30\",\"589:3\":\"17\",\"701:3\":\"162\",\"774:3\":\"241\",\"2181:3\":\"219\",\"797:3\":\"271\",\"505:3\":\"118\",\"2215:3\":\"282\",\"223:3\":\"98\",\"759:3\":\"240\",\"1102:3\":\"68\",\"687:3\":\"138\",\"857:3\":\"56\",\"431:3\":\"117\",\"664:3\":\"139\",\"2154:3\":\"110\",\"761:3\":\"224\",\"758:3\":\"239\",\"130:3\":\"45\",\"735:3\":\"125\",\"784:3\":\"246\",\"2192:3\":\"209\",\"191:3\":\"7\",\"383:3\":\"39\",\"712:3\":\"151\",\"904:3\":\"40\",\"2202:3\":\"295\",\"769:3\":\"255\",\"690:3\":\"135\",\"236:3\":\"95\",\"489:3\":\"12\",\"844:3\":\"74\",\"698:3\":\"165\",\"675:3\":\"183\",\"625:3\":\"107\",\"708:3\":\"155\",\"2188:3\":\"213\",\"2165:3\":\"89\",\"773:3\":\"259\",\"796:3\":\"270\",\"700:3\":\"163\",\"2180:3\":\"220\",\"372:3\":\"14\",\"723:3\":\"141\",\"977:3\":\"18\",\"2214:3\":\"283\",\"224:3\":\"97\",\"856:3\":\"53\",\"663:3\":\"193\",\"686:3\":\"172\",\"659:3\":\"197\",\"177:3\":\"44\",\"719:3\":\"144\",\"2199:3\":\"202\",\"369:3\":\"21\",\"760:3\":\"223\",\"783:3\":\"245\",\"2153:3\":\"122\",\"757:3\":\"238\",\"711:3\":\"152\",\"734:3\":\"126\",\"2191:3\":\"210\",\"768:3\":\"254\",\"2201:3\":\"200\",\"2549:3\":\"103\",\"139:3\":\"169\",\"843:3\":\"75\",\"674:3\":\"184\",\"697:3\":\"166\",\"373:3\":\"15\",\"624:3\":\"108\",\"1036:3\":\"20\",\"418:3\":\"112\",\"2164:3\":\"90\",\"2187:3\":\"214\",\"707:3\":\"156\",\"772:3\":\"258\",\"795:3\":\"269\",\"722:3\":\"171\",\"2213:3\":\"284\",\"662:3\":\"194\",\"685:3\":\"173\",\"855:3\":\"54\",\"842:3\":\"76\",\"2198:3\":\"203\",\"718:3\":\"145\",\"782:3\":\"244\",\"756:3\":\"237\",\"733:3\":\"124\",\"2190:3\":\"211\",\"2200:3\":\"201\",\"230:3\":\"99\",\"299:3\":\"128\",\"710:3\":\"153\",\"767:3\":\"230\",\"422:3\":\"47\",\"673:3\":\"185\",\"865:3\":\"66\",\"696:3\":\"129\",\"646:3\":\"64\",\"669:3\":\"189\",\"120:3\":\"4\",\"1037:3\":\"42\",\"2140:3\":\"28\",\"2186:3\":\"215\",\"771:3\":\"257\",\"794:3\":\"268\",\"2163:3\":\"71\",\"2209:3\":\"288\",\"706:3\":\"157\",\"975:3\":\"2\",\"721:3\":\"142\",\"779:3\":\"263\",\"2212:3\":\"285\",\"661:3\":\"195\",\"684:3\":\"174\",\"128:3\":\"31\",\"495:3\":\"51\",\"854:3\":\"55\",\"179:3\":\"10\",\"2159:3\":\"73\",\"363:3\":\"34\",\"841:3\":\"82\",\"171:3\":\"46\",\"717:3\":\"146\",\"781:3\":\"243\",\"2197:3\":\"204\",\"2219:3\":\"278\",\"302:3\":\"127\",\"755:3\":\"236\",\"766:3\":\"229\",\"789:3\":\"251\",\"513:3\":\"61\",\"732:3\":\"123\",\"118:3\":\"3\",\"672:3\":\"186\",\"695:3\":\"130\",\"423:3\":\"11\",\"849:3\":\"80\",\"400:3\":\"16\",\"292:3\":\"49\",\"803:3\":\"275\",\"144:3\":\"140\",\"853:3\":\"57\",\"668:3\":\"190\",\"2208:3\":\"289\",\"705:3\":\"158\",\"770:3\":\"256\",\"2546:3\":\"102\",\"793:3\":\"267\",\"2211:3\":\"286\",\"720:3\":\"143\",\"778:3\":\"262\",\"974:3\":\"1\",\"204:3\":\"5\",\"2448:3\":\"29\",\"683:3\":\"175\",\"2041:3\":\"121\",\"660:3\":\"196\",\"838:3\":\"84\",\"496:3\":\"50\",\"473:3\":\"25\",\"679:3\":\"179\",\"217:3\":\"9\",\"780:3\":\"242\",\"2196:3\":\"205\",\"2218:3\":\"279\",\"716:3\":\"147\",\"765:3\":\"228\",\"754:3\":\"235\",\"788:3\":\"250\",\"2221:3\":\"276\",\"535:3\":\"23\",\"2548:3\":\"104\",\"2206:3\":\"291\",\"802:3\":\"274\",\"848:3\":\"78\",\"694:3\":\"131\",\"671:3\":\"187\",\"667:3\":\"191\",\"1035:3\":\"19\",\"852:3\":\"52\",\"2169:3\":\"69\",\"399:3\":\"22\",\"168:3\":\"168\",\"792:3\":\"266\",\"2207:3\":\"290\",\"704:3\":\"159\",\"2547:3\":\"101\",\"2184:3\":\"216\",\"2161:3\":\"72\",\"391:3\":\"32\",\"777:3\":\"261\",\"2210:3\":\"287\",\"243:3\":\"94\",\"973:3\":\"41\",\"289:3\":\"48\",\"508:3\":\"59\",\"837:3\":\"85\",\"682:3\":\"176\",\"644:3\":\"65\"}";
        String mailString = "0:130000,1:130100,2:290210,3:101090200,4:1,5:202,6:1,7:0.0,8:0.0,9:2,10:0.0,11:20203,12:0.0,13:10,14:-1,15:559,16:130607,17:20,18:0.0,19:0.0,20:4.801347,21:10873,22:982,23:140301,24:20,25:0.0,26:0.0,27:0.0,28:0.0,29:290210,30:101090200,31:0.0,32:3,33:22099882,34:64470249,35:130602,36:101101,37:301,38:808,39:290000,40:290200,41:0.0,42:3,43:4,44:101,45:206,46:0.0,47:5,48:6,49:0.584718,50:0.308644,51:1.0,52:1.0,53:0.244452,54:0.292368,55:1.0,56:0.197817,57:0.216561,58:0.217637,59:0.0,60:0.0,61:1.0,62:0.0,63:0.618958,64:0.0,65:0.902599,66:1.0,67:0.0,68:0.0,69:0.0,70:0.216561,71:1.0,72:1.0,73:0.0,74:0.0,75:0.0,76:0.0,77:0.0,78:0.0,79:0.0,80:0.4,81:0.0,82:0.0,83:0.0,84:0.0,85:0.0,86:0.0,87:0.0,88:0.0,89:0.0,90:0.0,91:0.0,92:0.091,93:0.853,94:0.115,95:0.995,96:0.111,97:0.948,98:0.077,99:0.742,100:0.0,101:1.5,102:0.0,103:4,104:0.0,105:1.0,106:0.00124,107:0.0,108:1.0,109:0.0,110:0.0,111:3390873,112:17652,113:17145,114:3390690,115:11.2172,116:1.0943,117:0.299188,118:0.276747,119:0.005277362,120:5,121:0.0,122:0.0,123:0.0,124:0.0,125:1,126:20.0,127:5.0,128:4,129:28,130:1,131:0.0,132:1,133:4,134:0.0,135:5,136:3,137:0.0,138:3,139:14.0,140:117,141:6,142:0.0,143:43,144:1,145:0.0,146:2,147:4,148:0.0,149:28,150:1,151:0.0,152:1,153:11,154:4,155:5,156:0.0,157:10,158:4,159:0.0,160:4,161:4,162:0.0,163:5,164:3,165:0.0,166:3,167:5.0,168:0.0,169:0.0626,170:277,171:9,172:0.0,173:153,174:2,175:1,176:3,177:6,178:0.0,179:10,180:2,181:1,182:2,183:90,184:65,185:66,186:6,187:89,188:6,189:4,190:64,191:44,192:4,193:52,194:3,195:1,196:41,197:0.0,198:53.0,199:3,200:0.0,201:58,202:2,203:1,204:3,205:2,206:0.0,207:10,208:2,209:1,210:2,211:5,212:2,213:11,214:0.0,215:3,216:2,217:2,218:3,219:0.0,220:0.0,221:0.0,222:0.14285715,223:1.0,224:0.0,225:0.035714287,226:0.8,227:0.0,228:1.0,229:0.0,230:0.6,231:4.0,232:0.0,233:1.0,234:0.0,235:0.035714287,236:0.8,237:0.0,238:1.0,239:0.0,240:0.6,241:3.0,242:0.0,243:0.5,244:0.0,245:0.046511628,246:0.5,247:0.0,248:1.0,249:0.0,250:0.4,251:0.094017096,252:0.034188036,253:0.6,254:0.0,255:1.0,256:0.5,257:0.2,258:0.84615386,259:0.09756097,260:0.07317073,261:0.024390243,262:0.78846157,263:0.05882353,264:0.0,265:0.6666667,266:0.33333334,267:0.019607844,268:0.74157304,269:0.14634146,270:0.14634146,271:0.0625,272:0.71910113,273:0.32490975,274:0.23465703,275:1.0,276:0.0,277:0.6666667,278:0.33333334,279:0.05172414,280:1.0,281:0.0,282:1.0,283:0.5,284:0.2,285:1.6666666,286:0.6666667,287:0.0,288:0.0,289:0.27272728,290:0.6666667,291:0.0,292:0.0,293:0.0,294:0.0";
        String modelString = "{1:220000.0},{2:220300.0},{3:220301.0},{4:1.010401E8},{5:-1.0},{6:202.0},{7:7.0},{8:0.0},{9:2.0},{10:2.0},{11:0.0},{12:20203.0},{13:0.0},{14:0.0},{15:5.0},{16:0.0},{17:500112.0},{18:21.0},{19:0.0},{20:0.0},{21:6.400000095367432},{22:11552.0},{23:2547.0},{24:220301.0},{25:21.0},{26:9.0},{27:4.0},{28:-1.0},{29:2.0},{30:140301.0},{31:1.010401E8},{32:0.0},{33:1.0},{34:2.9761539E7},{35:79.0},{36:500103.0},{37:100303.0},{38:302.0},{39:0.0},{40:160000.0},{41:140300.0},{42:0.0},{43:7.0},{44:9.0},{45:101.0},{46:201.0},{47:0.0},{48:4.0},{49:9.0},{50:0.6034225821495056},{51:0.5674870014190674},{52:1.0},{53:0.40328601002693176},{54:0.658191978931427},{55:0.35713300108909607},{56:1.0},{57:1.0},{58:0.9477149844169617},{59:0.0},{60:0.0},{61:0.0},{62:1.0},{63:0.061521999537944794},{64:0.6642199754714966},{65:0.2594060003757477},{66:0.8076369762420654},{67:0.07534399628639221},{68:0.0},{69:0.0},{70:0.061521999537944794},{71:1.0},{72:1.0},{73:0.1449439972639084},{74:0.0},{75:0.0},{76:0.0},{77:0.0},{78:0.0},{79:0.0},{80:0.0},{81:0.1944900006055832},{82:0.1961890012025833},{83:0.20000000298023224},{84:1.0},{85:1.0},{86:0.0},{87:0.0},{88:0.0},{89:0.0},{90:0.0},{91:0.0},{92:0.0},{93:0.09799999743700027},{94:0.9179999828338623},{95:0.12800000607967377},{96:1.1269999742507935},{97:0.09200000017881393},{98:0.9490000009536743},{99:0.18700000643730164},{100:1.4620000123977661},{101:-1.0},{102:0.5},{103:103.0},{104:1.0},{105:0.019999999552965164},{106:0.06795000284910202},{107:0.06795000284910202},{108:0.019999999552965164},{109:0.4665936529636383},{110:0.4307507872581482},{111:0.4307507872581482},{112:155647.0},{113:65637.0},{114:10958.0},{115:4567755.0},{116:4.095300197601318},{117:0.4087},{118:0.2479729950428009},{119:0.11665499955415726},{120:0.0043098777532577515},{121:6.0},{122:0.4000000059604645},{123:0.0},{124:0.0},{125:0.0},{126:0.0},{127:33.0},{128:0.0},{129:220.0},{130:29.0},{131:1.0},{132:1.0},{133:29.0},{134:262.0},{135:16.0},{136:2632.0},{137:159.0},{138:103.0},{139:229.0},{140:1.0},{141:6121.0},{142:61.0},{143:59.0},{144:0.0},{145:0.0},{146:0.0},{147:0.0},{148:61.0},{149:59.0},{150:0.0},{151:0.0},{152:0.0},{153:0.0},{154:889.0},{155:83.0},{156:84.0},{157:7.0},{158:895.0},{159:61.0},{160:39.0},{161:83.0},{162:84.0},{163:7.0},{164:895.0},{165:61.0},{166:39.0},{167:83.0},{168:2.0},{169:10.0},{170:0.0013096478069201112},{171:510.0},{172:27.0},{173:2.0},{174:89.0},{175:19.0},{176:4.0},{177:20.0},{178:7.0},{179:1.0},{180:23.0},{181:1.0},{182:0.0},{183:1.0},{184:204.0},{185:166.0},{186:121.0},{187:5.0},{188:126.0},{189:5.0},{190:1.0},{191:102.0},{192:61.0},{193:0.0},{194:71.0},{195:4.0},{196:1.0},{197:57.0},{198:4.0},{199:32.0},{200:27.0},{201:2.0},{202:89.0},{203:19.0},{204:4.0},{205:20.0},{206:7.0},{207:1.0},{208:23.0},{209:1.0},{210:0.0},{211:1.0},{212:115.0},{213:5.0},{214:111.0},{215:5.0},{216:90.0},{217:57.0},{218:0.0},{219:66.0},{220:4.0},{221:1.0},{222:52.0},{223:0.0},{224:0.03448275849223137},{225:0.03448275849223137},{226:1.0},{227:0.09954407066106796},{228:0.06986899673938751},{229:0.6943231225013733},{230:0.4497816562652588},{231:0.08700607717037201},{232:0.0},{233:0.0},{234:0.0},{235:0.0},{236:0.0},{237:0.09385474771261215},{238:0.0},{239:0.7349397540092468},{240:0.46987950801849365},{241:0.09273742884397507},{242:0.0},{243:0.0},{244:0.0},{245:0.0},{246:0.0},{247:0.09385474771261215},{248:0.0},{249:0.7349397540092468},{250:0.46987950801849365},{251:0.09273742884397507},{252:0.14523769915103912},{253:0.013559876009821892},{254:0.30434781312942505},{255:1.0},{256:1.0},{257:0.0},{258:0.043478261679410934},{259:0.8591549396514893},{260:0.0},{261:0.07017543911933899},{262:0.017543859779834747},{263:0.8028169274330139},{264:0.30337077379226685},{265:0.10000000149011612},{266:0.949999988079071},{267:0.20000000298023224},{268:0.2247191071510315},{269:0.9603174328804016},{270:0.08771929889917374},{271:0.08771929889917374},{272:0.009803921915590763},{273:0.8095238208770752},{274:0.4000000059604645},{275:0.32549020648002625},{276:1.350000023841858},{277:0.10000000149011612},{278:0.949999988079071},{279:0.20000000298023224},{280:0.2247191071510315},{281:7.0},{282:1.0},{283:1.0},{284:0.0},{285:0.043478261679410934},{286:1.2777777910232544},{287:0.0555555559694767},{288:0.0555555559694767},{289:0.011111111380159855},{290:0.8108108043670654},{291:0.8636363744735718},{292:0.0},{293:0.07692307978868484},{294:0.01923076994717121},{295:0.7878788113594055}";

        // 比较进入模型的特征和打印出来的特征是否一致

        // 处理邮件里的特征
        String[] features = mailString.split(",");
        Map<String, String> mailFeaturesMap = new HashMap<>();
        for (String s : features) {
            String[] st = s.split(":");
            mailFeaturesMap.put(st[0], st[1]);
        }

        // 处理进模型前的特征
        String[] javaModelFeatures = modelString.split(",");
        Map<String, String> javaFeaturesMap = new HashMap<>();
        for (String s : javaModelFeatures) {
            String a = s.replace('{', ' ').replace('}', ' ').trim();
            String[] st = a.split(":");
            javaFeaturesMap.put(st[0], st[1]);
        }
        Set<String> s3CodeSet = new HashSet<>();
        // 邮件里的特征map
        Map<String, String> mailRealFeature = new HashMap<>();

        // 进模型前的特征map
        Map<String, String> javaRealFeature = new HashMap<>();
        JSONObject s3Json = JSONObject.parseObject(s3);
        Set<String> s3KeySet = s3Json.keySet();
        for (String key : s3KeySet) {
            String index = s3Json.getString(key);
            int mailIndex = Integer.parseInt(index) - 1;
            String value = mailFeaturesMap.get(mailIndex + "");

            String k = key.split(":")[0];
            mailRealFeature.put(k, value);

            int javaIndex = mailIndex + 1;
            String javaValue = javaFeaturesMap.get(javaIndex + "");
            javaRealFeature.put(k, javaValue);
            s3CodeSet.add(k);
        }
        System.out.println("traceCode:" + hiveCode.size() + ", featureCode:" + s3CodeSet.size());
        for (String s : hiveCode) {
            if (!s3CodeSet.contains(s)) {
                System.out.print(s + ",");
            }
        }
        System.out.println("============");
        Set<String> activeFeatureSet = activeFeatures.keySet();
        int count = 0;
        for (String key : activeFeatureSet) {
            String javaModelValue = javaRealFeature.get(key);
            String sampleValue = activeFeatures.getString(key);
            String traceValue = traceFeatures.getString(key);
            String hiveValue = hiveFeatures.getString(key);
            String mailValue = mailRealFeature.get(key);
            if (javaModelValue == null || hiveValue == null) {
                System.out.println(key);
                continue;
            }
            try{
                Float.parseFloat(hiveValue);
            }catch (Exception e){
                continue;
            }

//            if (Float.parseFloat(sampleValue)!=Float.parseFloat(javaModelValue)) {
//                System.out.println(key + "--" + "sampleValue: " + sampleValue + ", javaModelValue: " + javaModelValue);
//            }

            if (Float.parseFloat(hiveValue)!=Float.parseFloat(javaModelValue)) {
                System.out.println(key + "--" + "hiveValue: " + hiveValue + ", javaModelValue: " + javaModelValue + ", sampleValue: " + sampleValue );
            }

//            if (!sampleValue.equals(traceValue)) {
//                System.out.println(key + "--" + "sampleValue: " + sampleValue + ", traceValue: " + traceValue);
//            }
//            if(traceValue == null){
//                System.out.println("key: " + key);
//                continue;
//            }
//            if (!traceValue.equals(mailValue)){
//                System.out.println(key + "--" + "traceValue: " + traceValue + ", mailValue: " + mailValue);
//                count++;
//            }
        }
        System.out.println("=============================================");
        Set<String> passiveFeatureSet = passiveFeatures.keySet();
        for (String key : passiveFeatureSet) {
            String javaModelValue = javaRealFeature.get(key);
            String sampleValue = passiveFeatures.getString(key);
            String traceValue = traceFeatures.getString(key);
            String hiveValue = hiveFeatures.getString(key);
            String mailValue = mailRealFeature.get(key);

            if (javaModelValue == null || hiveValue == null) {
                System.out.println(key);
                continue;
            }

            try{
                Float.parseFloat(hiveValue);
            }catch (Exception e){
                continue;
            }

//            if (Float.parseFloat(sampleValue)!=Float.parseFloat(javaModelValue)) {
//                System.out.println(key + "--" + "sampleValue: " + sampleValue + ", javaModelValue: " + javaModelValue);
//            }

            if (Float.parseFloat(hiveValue) != Float.parseFloat(javaModelValue)) {
                System.out.println(key + "--" + "hiveValue: " + hiveValue + ", javaModelValue: " + javaModelValue + ", sampleValue: " + sampleValue);
            }

//            if (!sampleValue.equals(traceValue)) {
//                System.out.println(key + "--" + "sampleValue: " + sampleValue + ", traceValue: " + traceValue);
//            }
//            if(traceValue == null){
//                System.out.println("key: " + key);
//                continue;
//            }
//            if (!traceValue.equals(mailValue)){
//                System.out.println(key + "--" + "traceValue: " + traceValue + ", mailValue: " + mailValue);
//                count++;
//            }
        }
//        System.out.println(realFeature);

    }


    public static void compareTrace2Model() {

    }
}
